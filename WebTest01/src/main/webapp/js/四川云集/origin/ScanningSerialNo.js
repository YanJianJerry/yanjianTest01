var ScanningSerialNo_ClassName = "ScanningSerialNo";
var ScanningSerialNo_Div_01 = "ScanningSerialNo_Div_01";
var ScanningSerialNo_Div_02 = "ScanningSerialNo_Div_02";
var ScanningSerialNo_Div_03 = "ScanningSerialNo_Div_03";
var ScanningSerialNo_DivsArray = new Array();
var ScanningSerialNo_Lbl_Message_1 = "ScanningSerialNo_Lbl_Message_1";
var ScanningSerialNo_Lbl_Message_3 = "ScanningSerialNo_Lbl_Message_3";
var ScanningSerialNo_Wxt_OrderQty = "ScanningSerialNo_Wxt_OrderQty";
var ScanningSerialNo_Wxt_ScannedQty = "ScanningSerialNo_Wxt_ScannedQty";
var ScanningSerialNo_Wxt_OrderQty_2 = "ScanningSerialNo_Wxt_OrderQty_2";
var ScanningSerialNo_Wxt_ScannedQty_2 = "ScanningSerialNo_Wxt_ScannedQty_2";
var ScanningSerialNo_Chk_CheckQty_1 = "ScanningSerialNo_Chk_CheckQty_1";
var ScanningSerialNo_Txt_SerialNo = "ScanningSerialNo_Txt_SerialNo";
var ScanningSerialNo_Txt_SerialNo_From = "ScanningSerialNo_Txt_SerialNo_From";
var ScanningSerialNo_Txt_SerialNo_To = "ScanningSerialNo_Txt_SerialNo_To";
var ScanningSerialNo_Txt_SubSerialNo = "ScanningSerialNo_Txt_SubSerialNo";
var ScanningSerialNo_Txt_SubSerialNo_From = "ScanningSerialNo_Txt_SubSerialNo_From";
var ScanningSerialNo_Txt_SubSerialNo_To = "ScanningSerialNo_Txt_SubSerialNo_To";
var ScanningSerialNo_But_GetSerialNoByTraceID = "ScanningSerialNo_But_GetSerialNoByTraceID";
var ScanningSerialNo_But_ClearSerialNo = "ScanningSerialNo_But_ClearSerialNo";
var ScanningSerialNo_But_LoadSerialNo = "ScanningSerialNo_But_LoadSerialNo";
var ScanningSerialNo_But_Cancel = "ScanningSerialNo_But_Cancel";
var ScanningSerialNo_But_GiveUp = "ScanningSerialNo_But_GiveUp";
var ScanningSerialNo_Div_ShowScannedSerialNoList = "ScanningSerialNo_Div_ShowScannedSerialNoList";
var ScanningSerialNo_Div_ShowAllSerialNoList = "ScanningSerialNo_Div_ShowAllSerialNoList";
var ScanningSerialNo_But_Confrim_2 = "ScanningSerialNo_But_Confrim_2";
var ScanningSerialNo_Div_ShowButton = "ScanningSerialNo_Div_ShowButton";
var ScanningSerialNo_Txt_UserId_3 = "ScanningSerialNo_Txt_UserId_3";
var ScanningSerialNo_Txt_Password_3 = "ScanningSerialNo_Txt_Password_3";
var ScanningSerialNo_But_Confirm_3 = "ScanningSerialNo_But_Confirm_3";
var ScanningSerialNo_But_Cancel_3 = "ScanningSerialNo_But_Cancel_3";
var ScanningSerialNo_SerialNoListTableId = "ScanningSerialNo_SerialNoListTableId";
var ScanningSerialNo_AllSerialNoListTableId = "ScanningSerialNo_AllSerialNoListTableId";
var ScanningSerialNo_TableTitle = new Array("SerialNo");
var ScanningSerialNo_TableBody = new Array();
var ScanningSerialNo_DeleteSerialNo = new Array();
var ScanningSerialNo_TableMinLineNumber = 8;
var ScanningSerialNo_TableMaxLineNumber = 8;
var ScanningSerialNo_TableMinLineNumber2 = 12;
var ScanningSerialNo_TableMaxLineNumber2 = 9999;
var ScanningSerialNo_SCANNED = "SCANNED";
var ScanningSerialNo_SAVED = "SAVED";
var ScanningSerialNo_MaxQty = 0;
var ScanningSerialNo_QtyUom = "";
var ScanningSerialNo_ScannedQty = 0;
var ScanningSerialNo_firstNumber = -1;
var ScanningSerialNo_lastNumber = -1;
var ScanningSerialNo_NumberLength = -1;
var ScanningSerialNo_Prefixion = "";
var ScanningSerialNo_Suffixion = "";
var ScanningSerialNo_CanOverQty = false;
var ScanningSerialNo_webRoot = "";
var ScanningSerialNo_AsnNo = "";
var ScanningSerialNo_WarehouseId = "";
var ScanningSerialNo_CustomerId = "";
var ScanningSerialNo_OrderType = "";
var ScanningSerialNo_Sku = "";
var ScanningSerialNo_Hide_GetSerialListSql_1 = "ScanningSerialNo_Hide_GetSerialListSql_1";
var ScanningSerialNo_Hide_AsnNo_1 = "ScanningSerialNo_Hide_AsnNo_1";
var ScanningSerialNo_Hide_Type_1 = "ScanningSerialNo_Hide_Type_1";
var ScanningSerialNo_Hide_CustomerId_1 = "ScanningSerialNo_Hide_CustomerId_1";
var ScanningSerialNo_Hide_Sku_1 = "ScanningSerialNo_Hide_Sku_1";
var ScanningSerialNo_QKeys = new Array(ScanningSerialNo_Hide_GetSerialListSql_1, ScanningSerialNo_Hide_AsnNo_1, ScanningSerialNo_Hide_Type_1, ScanningSerialNo_Hide_CustomerId_1, ScanningSerialNo_Hide_Sku_1);
var ScanningSerialNo_SerialNoIsStockList_1 = "";
var ScanningSerialNo_SerialNoBufferList_1 = null;
var ScanningSerialNo_SerialNoRul_1 = null;
var ScanningSerialNo_SerialNoRul_2 = null;
var ScanningSerialNo_Module = "";
var ScanningSerialNo_isOracle = "";
var ScanningSerialNo_GiveUpFlag = false;
var ScanningSerialNo_ScannedFirstSerialNoList_1 = new Array();
var ScanningSerialNo_SN_BCH = "";
var ScanningSerialNo_SN_INC = "";
var ScanningSerialNo_SN_DSP_CTL = "";
var ScanningSerialNo_IND_MED = "";
var ScanningSerialNo_SN_CTL = "";
var ScanningSerialNo_SN_VAL_LST_S = "";
var ScanningSerialNo_SN_VAL_LST_I = "";
var ScanningSerialNo_Message_01 = "";
var ScanningSerialNo_Message_02 = "";
var ScanningSerialNo_Message_03 = "";
var ScanningSerialNo_Message_04 = "";
var ScanningSerialNo_Message_05 = "";
var ScanningSerialNo_Message_06 = "";
var ScanningSerialNo_Message_07 = "";
var ScanningSerialNo_Message_08 = "";
var ScanningSerialNo_Message_09 = "";
var ScanningSerialNo_Message_10 = "";
var ScanningSerialNo_Message_11 = "";
var ScanningSerialNo_Message_12 = "";
var ScanningSerialNo_Message_13 = "";
var ScanningSerialNo_Message_14 = "";
var ScanningSerialNo_Message_15 = "";
var ScanningSerialNo_Message_16 = "";
var ScanningSerialNo_GetSerialNoByTraceID = "";
var ScanningSerialNo_ClearSerialNo = "";
var ScanningSerialNo_LoadSerialNo = "";
var ScanningSerialNo_Cancel = "";
var ScanningSerialNo_GiveUp = "";
var ScanningSerialNo_SerialNo = "";
var ScanningSerialNo_SubSerialNo = "";

function first_ActionControl(id, event) {
    if (event == null || event.keyCode == 13) {
        if (false) {
            initHtmlPage();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_SerialNo) {
            ScanningSerialNo_Txt_SerialNo_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_SerialNo_From) {
            ScanningSerialNo_Txt_SerialNo_From_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_SerialNo_To) {
            ScanningSerialNo_Txt_SerialNo_To_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_SubSerialNo) {
            ScanningSerialNo_Txt_SubSerialNo_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_SubSerialNo_From) {
            ScanningSerialNo_Txt_SubSerialNo_From_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_SubSerialNo_To) {
            ScanningSerialNo_Txt_SubSerialNo_To_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_GetSerialNoByTraceID) {
            ScanningSerialNo_But_GetSerialNoByTraceID_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_ClearSerialNo) {
            ScanningSerialNo_ClearSerialNo_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_LoadSerialNo) {
            ScanningSerialNo_But_LoadSerialNo_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_Cancel) {
            ScanningSerialNo_But_Cancel_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_GiveUp) {
            ScanningSerialNo_But_GiveUp_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_Confrim_2) {
            ScanningSerialNo_But_Confrim_2_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_UserId_3) {
            ScanningSerialNo_Txt_UserId_3_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_Txt_Password_3) {
            ScanningSerialNo_Txt_Password_3_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_Confirm_3) {
            ScanningSerialNo_But_Confirm_3_Action();
            return;
        }
        ;
        if (id == ScanningSerialNo_But_Cancel_3) {
            ScanningSerialNo_But_Cancel_3_Action();
            return;
        }
        ;alert("function first_ActionControl() is Error: " + id + " not found.");
    }
};

function ScanningSerialNo_Init(divsArray, maxQty, qtyUom, returnPage, canOverQty, buttons, module) {
    ScanningSerialNo_Init_Private(divsArray, maxQty, qtyUom, returnPage, canOverQty, buttons, module);
};

function ScanningSerialNo_AddScannedSerialNo(scannedSerialNo) {
    ScanningSerialNo_AddScannedSerialNo_Private(scannedSerialNo);
};

function ScanningSerialNo_GetScannedSerialNo() {
    var returnArray = new Array();
    for (var i = 0; i < ScanningSerialNo_TableBody.length; i++) {
        if (ScanningSerialNo_TableBody[i] == " ") {
            continue;
        } else {
            returnArray.push(ScanningSerialNo_TableBody[i]);
        }
    }
    ;
    return returnArray.slice(0);
};

function ScanningSerialNo_GetScannedFirstSerialNo() {
    return ScanningSerialNo_ScannedFirstSerialNoList_1;
};

function ScanningSerialNo_GetDeletedSerialNo() {
    return ScanningSerialNo_DeleteSerialNo.slice(0);
};

function ScanningSerialNo_CheckSerialNoByDatabaseEnd(isOk, serialNos, errorMessage) {
    ScanningSerialNo_CheckSerialNoByDatabaseEnd_Private(isOk, serialNos, errorMessage);
};

function ScanningSerialNo_ClearAllSerialNoAndRefresh() {
    ScanningSerialNo_ClearAllSerialNoAndRefresh_Private();
};

function ScanningSerialNo_ClearAllSerialNo() {
    ScanningSerialNo_ClearAllSerialNo_Private();
};

function ScanningSerialNo_ClearSerialNoInputText() {
    ScanningSerialNo_ClearSerialNoInputText_Private();
};

function ScanningSerialNo_FocusSerialNoInputText() {
    ScanningSerialNo_FocusSerialNoInputText_Private();
};

function ScanningSerialNo_ShowMessage(message) {
    ScanningSerialNo_ShowMessage_Private(message);
};

function ScanningSerialNo_RefreshSerialNoTabel() {
    ScanningSerialNo_RefreshSerialNoTabel_Private();
};

function ScanningSerialNo_SetAsnInfo(asnNo, warehouseId, customerId, orderType) {
    ScanningSerialNo_AsnNo = asnNo;
    ScanningSerialNo_WarehouseId = warehouseId;
    ScanningSerialNo_CustomerId = customerId;
    ScanningSerialNo_OrderType = orderType;
};

function ScanningSerialNo_SetSkuInfo(type, sku, customerId) {
    ScanningSerialNo_Sku = sku;
    ScanningSerialNo_CustomerId = customerId;
    setValue(ScanningSerialNo_Hide_Type_1, type);
    setValue(ScanningSerialNo_Hide_Sku_1, sku);
    setValue(ScanningSerialNo_Hide_CustomerId_1, customerId);
};

function ScanningSerialNo_IsGiveUp() {
    return ScanningSerialNo_GiveUpFlag;
};

function ScanningSerialNo_But_GetSerialNoByTraceID_Action() {
    alert("You need overwrite the function: ScanningSerialNo_But_GetSerialNoByTraceID_Action(). And try it again.");
};

function ScanningSerialNo_ClearSerialNo_Action() {
    alert("You need overwrite the function: ScanningSerialNo_ClearSerialNo_Action(). And try it again.");
};

function ScanningSerialNo_But_LoadSerialNo_Action() {
    alert("You need overwrite the function: ScanningSerialNo_But_LoadSerialNo_Action(). And try it again.");
};

function ScanningSerialNo_But_Cancel_Action() {
    alert("You need overwrite the function: ScanningSerialNo_But_Cancel_Action(). And try it again.");
};

function ScanningSerialNo_OtherCheckSerialNo(serialNos) {
    return 0;
};

function ScanningSerialNo_CheckSerialNoByDatabase(serialNos) {
    ScanningSerialNo_CheckSerialNoByDatabaseEnd(true, serialNos, "");
};

function ShowTable_DeleteClick_Action(tableId, index) {
};

function ShowTable_SingleClick_Action(tableId, index) {
};

function ShowTable_DoubleClick_Action(tableId, index) {
};

function ShowTable_ShowAllInfoList(tableId) {
};

function ScanningSerialNo_Init_Private(divsArray, maxQty, qtyUom, returnPage, canOverQty, buttons, module) {
    ScanningSerialNo_SetParameter();
    ScanningSerialNo_ShowButton(buttons);
    ScanningSerialNo_DeleteSerialNo = new Array();
    ScanningSerialNo_TableBody = new Array();
    ScanningSerialNo_DivsArray = divsArray;
    var isExist = false;
    for (var i = 0; i < ScanningSerialNo_DivsArray.length; i++) {
        if (ScanningSerialNo_DivsArray[i] == ScanningSerialNo_Div_01) {
            isExist = true;
            break;
        }
    }
    ;
    if (!isExist) {
        ScanningSerialNo_DivsArray.push(ScanningSerialNo_Div_01);
        ScanningSerialNo_DivsArray.push(ScanningSerialNo_Div_02);
        ScanningSerialNo_DivsArray.push(ScanningSerialNo_Div_03);
    }
    ;setValue(ScanningSerialNo_Hide_Type_1, first_GetParameterValue(ScanningSerialNo_SN_CTL, ScanningSerialNo_CustomerId, ScanningSerialNo_OrderType, ScanningSerialNo_WarehouseId));
    ScanningSerialNo_MaxQty = maxQty;
    ScanningSerialNo_QtyUom = qtyUom;
    ScanningSerialNo_ScannedQty = 0;
    setValue(ScanningSerialNo_Wxt_OrderQty, ScanningSerialNo_Message_01.replace("&1", ScanningSerialNo_MaxQty + ScanningSerialNo_QtyUom));
    setValue(ScanningSerialNo_Wxt_ScannedQty, ScanningSerialNo_Message_02.replace("&1", ScanningSerialNo_ScannedQty));
    setValue(ScanningSerialNo_Wxt_OrderQty_2, ScanningSerialNo_Message_01.replace("&1", ScanningSerialNo_MaxQty + ScanningSerialNo_QtyUom));
    setValue(ScanningSerialNo_Wxt_ScannedQty_2, ScanningSerialNo_Message_02.replace("&1", ScanningSerialNo_ScannedQty));
    ScanningSerialNo_CanOverQty = canOverQty;
    ScanningSerialNo_SerialNoBufferList_1 = null;
    ScanningSerialNo_SerialNoRul_1 = null;
    ScanningSerialNo_Module = module;
    ScanningSerialNo_GiveUpFlag = false;
    ScanningSerialNo_ScannedFirstSerialNoList_1 = new Array();
    if (ScanningSerialNo_SN_BCH == "Y") {
        ScanningSerialNo_firstNumber = ScanningSerialNo_SN_INC.substring(0, ScanningSerialNo_SN_INC.indexOf(":"));
        ScanningSerialNo_lastNumber = ScanningSerialNo_SN_INC.substring(ScanningSerialNo_SN_INC.indexOf(":") + 1, ScanningSerialNo_SN_INC.length);
        if (ScanningSerialNo_SN_INC.indexOf(":") <= 0 || !first_IsInt(ScanningSerialNo_firstNumber) || !first_IsInt(ScanningSerialNo_lastNumber) || parseFloat(ScanningSerialNo_firstNumber) > parseFloat(ScanningSerialNo_lastNumber) || parseFloat(ScanningSerialNo_firstNumber) <= 0) {
            first_PlayMuiscByName("M111", getValue("hide_MusicList"), false);
            first_EchoMessage(ScanningSerialNo_Message_07, first_Alert, ScanningSerialNo_ShowMessage_Private);
            showViewSingle(returnPage, inViewsKeys);
            return;
        }
        ;ScanningSerialNo_NumberLength = parseFloat(ScanningSerialNo_lastNumber) - parseFloat(ScanningSerialNo_firstNumber) + 1;
    }
    ;
    if (ScanningSerialNo_AsnNo != null && ScanningSerialNo_AsnNo.length > 0 && first_GetParameterValue(ScanningSerialNo_SN_VAL_LST_I, ScanningSerialNo_CustomerId, ScanningSerialNo_OrderType, ScanningSerialNo_WarehouseId) == "1") {
        setValue(ScanningSerialNo_Hide_GetSerialListSql_1, first_GetParameterValue(ScanningSerialNo_SN_VAL_LST_S, ScanningSerialNo_CustomerId, ScanningSerialNo_OrderType, ScanningSerialNo_WarehouseId));
        setValue(ScanningSerialNo_Hide_AsnNo_1, ScanningSerialNo_AsnNo);
        _prevView = ScanningSerialNo_Div_01;
        showViewSingle(_div1Waiting, inViewsKeys);
        doServerAction(ScanningSerialNo_ClassName, "GetSerialListAction", ScanningSerialNo_QKeys, ScanningSerialNo_GetSerialListAction);
        return;
    } else {
        setValue(ScanningSerialNo_Hide_GetSerialListSql_1, "");
        setValue(ScanningSerialNo_Hide_AsnNo_1, "");
        _prevView = ScanningSerialNo_Div_01;
        showViewSingle(_div1Waiting, inViewsKeys);
        doServerAction(ScanningSerialNo_ClassName, "getSerialRulAction", ScanningSerialNo_QKeys, ScanningSerialNo_GetSerialRulAction);
        return;
    }
    ;ScanningSerialNo_GetSerialNoInStockAction();
};

function ScanningSerialNo_GetSerialListAction(responseText) {
    var replyData = null;
    try {
        replyData = eval('(' + responseText + ')');
    } catch (e) {
        alert(first_ErrorMessage01);
        setInnerHTML("waitingMsg", first_ErrorMessage01 + ":" + e.message);
        return;
    }
    ;var curSEQ = replyData.SEQ;
    if (curSEQ > first_lastSEQUpdate1) {
        first_lastSEQUpdate1 = curSEQ;
        var returnMessage = replyData.mesg;
        if (codeValue_OK == replyData.codeValue) {
            var obj1 = replyData.strData1;
            var obj2 = replyData.strData2;
            ScanningSerialNo_SerialNoBufferList_1 = obj2;
            ScanningSerialNo_SerialNoRul_1 = obj1;
            ScanningSerialNo_GetSerialNoInStockAction();
        } else if (codeValue_NORECORD == replyData.codeValue) {
            showViewSingle(_prevView, inViewsKeys);
        } else {
            showViewSingle(_prevView, inViewsKeys);
            first_EchoMessage(returnMessage, first_Alert, "");
        }
    }
};

function ScanningSerialNo_GetSerialRulAction(responseText) {
    var replyData = null;
    try {
        replyData = eval('(' + responseText + ')');
    } catch (e) {
        alert(first_ErrorMessage01);
        setInnerHTML("waitingMsg", first_ErrorMessage01 + ":" + e.message);
        return;
    }
    ;var curSEQ = replyData.SEQ;
    if (curSEQ > first_lastSEQUpdate1) {
        first_lastSEQUpdate1 = curSEQ;
        var returnMessage = replyData.mesg;
        if (codeValue_OK == replyData.codeValue) {
            var obj1 = replyData.strData1;
            ScanningSerialNo_SerialNoBufferList_1 = null;
            ScanningSerialNo_SerialNoRul_1 = obj1;
            ScanningSerialNo_GetSerialNoInStockAction();
        } else if (codeValue_NORECORD == replyData.codeValue) {
            showViewSingle(_prevView, inViewsKeys);
        } else {
            showViewSingle(_prevView, inViewsKeys);
            first_EchoMessage(returnMessage, first_Alert, "");
        }
    }
};

function ScanningSerialNo_GetSerialNoInStockAction() {
    var type = getValue2(ScanningSerialNo_Hide_Type_1);
    var sql = "";
    if (type == "1") {
        if (ScanningSerialNo_isOracle == "Y") {
            sql = "SELECT SERIALNO AS UDF01 FROM DOC_ASN_SERIALNO WHERE STOCKFLAG='Y'";
            sql += " AND SCANTIME IS NOT NULL";
            sql += " AND ROWNUM<=1000";
            sql += " ORDER BY SCANTIME DESC";
        } else {
            sql = "SELECT TOP 1000";
            sql += " SERIALNO AS UDF01 FROM DOC_ASN_SERIALNO WHERE STOCKFLAG='Y'";
            sql += " AND SCANTIME IS NOT NULL";
            sql += " ORDER BY SCANTIME DESC";
        }
    } else {
        if (ScanningSerialNo_isOracle == "Y") {
            sql = "SELECT SUBSERIALNO AS UDF01 FROM DOC_ASN_SUBSERIALNO WHERE STOCKFLAG='Y'";
            sql += " AND SCANTIME IS NOT NULL";
            sql += " AND ROWNUM<=1000";
            sql += " ORDER BY SCANTIME DESC";
        } else {
            sql = "SELECT TOP 1000";
            sql += " SUBSERIALNO AS UDF01 FROM DOC_ASN_SUBSERIALNO WHERE STOCKFLAG='Y'";
            sql += " AND SCANTIME IS NOT NULL";
            sql += " ORDER BY SCANTIME DESC";
        }
    }
    ;first_GetLongStringAction(sql, ScanningSerialNo_GetSerialNoInStockNextAction);
};

function ScanningSerialNo_GetSerialNoInStockNextAction(longString) {
    ScanningSerialNo_SerialNoIsStockList_1 = longString;
    ScanningSerialNo_ShowInitPage();
};var ScanningSerialNo_Div_ShowScanSerialNoText = "ScanningSerialNo_Div_ShowScanSerialNoText";

function ScanningSerialNo_ShowInitPage() {
    showViewSingle(ScanningSerialNo_Div_01, inViewsKeys);
    ScanningSerialNo_RefreshSerialNoTabel_Private(false);
    if (ScanningSerialNo_SerialNoRul_1 != null) {
        ScanningSerialNo_SN_BCH = ScanningSerialNo_SerialNoRul_1.SN_BCH;
        ScanningSerialNo_SN_INC = ScanningSerialNo_SerialNoRul_1.SN_INC;
    } else {
        ScanningSerialNo_SN_BCH = "N";
        ScanningSerialNo_SN_INC = "";
    }
    ;var type = getValue2(ScanningSerialNo_Hide_Type_1);
    if (ScanningSerialNo_SN_BCH == "Y") {
        ScanningSerialNo_firstNumber = ScanningSerialNo_SN_INC.substring(0, ScanningSerialNo_SN_INC.indexOf(":"));
        ScanningSerialNo_lastNumber = ScanningSerialNo_SN_INC.substring(ScanningSerialNo_SN_INC.indexOf(":") + 1, ScanningSerialNo_SN_INC.length);
        if (ScanningSerialNo_SN_INC.indexOf(":") <= 0 || !first_IsInt(ScanningSerialNo_firstNumber) || !first_IsInt(ScanningSerialNo_lastNumber) || parseFloat(ScanningSerialNo_firstNumber) > parseFloat(ScanningSerialNo_lastNumber) || parseFloat(ScanningSerialNo_firstNumber) <= 0) {
            first_PlayMuiscByName("M111", getValue("hide_MusicList"), false);
            first_EchoMessage(ScanningSerialNo_Message_07, first_Alert, ScanningSerialNo_ShowMessage_Private);
            showViewSingle(returnPage, inViewsKeys);
            return;
        }
        ;ScanningSerialNo_NumberLength = parseFloat(ScanningSerialNo_lastNumber) - parseFloat(ScanningSerialNo_firstNumber) + 1;
    }
    ;var serialNoCode = new Array();
    serialNoCode.push("<table class='border' width='100%' height='100%' cellpadding='0' cellspacing='0' border='0'>");
    if (type == "1") {
        if (ScanningSerialNo_SN_BCH == "Y") {
            serialNoCode.push("<tr>");
            serialNoCode.push("<td colspan='2' class='table_r_l'>" + ScanningSerialNo_SerialNo + "Fm</td>");
            serialNoCode.push("<td colspan='2' class='table_r_l'>" + ScanningSerialNo_SerialNo + "To</td>");
            serialNoCode.push("</tr><tr>");
            serialNoCode.push("<td colspan='2' class='table_c_l'><input type='text' class='input_text' id='ScanningSerialNo_Txt_SerialNo_From' onkeyup='ScanningSerialNo_Txt_SerialNo_From_Action(event)'/></td>");
            serialNoCode.push("<td colspan='2' class='table_c_l'><input type='text' class='input_text' id='ScanningSerialNo_Txt_SerialNo_To' onkeyup='ScanningSerialNo_Txt_SerialNo_To_Action(event)'/></td>");
            serialNoCode.push("</tr>");
        } else {
            serialNoCode.push("<tr><td colspan='4' class='table_r_l'>" + ScanningSerialNo_SerialNo + "</td></tr>");
            serialNoCode.push("<tr><td colspan='4' class='table_c_l'><input type='text' class='input_text_long' id='ScanningSerialNo_Txt_SerialNo' onkeyup='ScanningSerialNo_Txt_SerialNo_Action(event)'/></td></tr>");
        }
    } else {
        serialNoCode.push("<tr><td colspan='4' class='table_r_l'>" + ScanningSerialNo_SerialNo + "</td></tr>");
        serialNoCode.push("<tr><td colspan='4' class='table_c_l'><input type='text' class='input_text_long' id='ScanningSerialNo_Txt_SerialNo' onkeyup='ScanningSerialNo_Txt_SerialNo_Action(event)'/></td></tr>");
        if (ScanningSerialNo_SN_BCH == "Y") {
            serialNoCode.push("<tr>");
            serialNoCode.push("<td colspan='2' class='table_r_l'>" + ScanningSerialNo_SubSerialNo + "Fm</td>");
            serialNoCode.push("<td colspan='2' class='table_r_l'>" + ScanningSerialNo_SubSerialNo + "To</td>");
            serialNoCode.push("</tr><tr>");
            serialNoCode.push("<td colspan='2' class='table_c_l'><input type='text' class='input_text' id='ScanningSerialNo_Txt_SubSerialNo_From' onkeyup='ScanningSerialNo_Txt_SubSerialNo_From_Action(event)'/></td>");
            serialNoCode.push("<td colspan='2' class='table_c_l'><input type='text' class='input_text' id='ScanningSerialNo_Txt_SubSerialNo_To' onkeyup='ScanningSerialNo_Txt_SubSerialNo_To_Action(event)'/></td>");
            serialNoCode.push("</tr>");
        } else {
            serialNoCode.push("<tr><td colspan='4' class='table_r_l'>" + ScanningSerialNo_SubSerialNo + "</td></tr>");
            serialNoCode.push("<tr><td colspan='4' class='table_c_l'><input type='text' class='input_text_long' id='ScanningSerialNo_Txt_SubSerialNo' onkeyup='ScanningSerialNo_Txt_SubSerialNo_Action(event)'/></td></tr>");
        }
    }
    ;serialNoCode.push("</table>");
    setInnerHTML(ScanningSerialNo_Div_ShowScanSerialNoText, serialNoCode.join(""));
    if (type == "1") {
        if (ScanningSerialNo_SN_BCH == "Y") {
            setFocus(ScanningSerialNo_Txt_SerialNo_From);
            first_PlayMuiscByName("M110", getValue("hide_MusicList"), true);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_04);
        } else {
            setFocus(ScanningSerialNo_Txt_SerialNo);
            first_PlayMuiscByName("M114", getValue("hide_MusicList"), true);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_03);
        }
    } else {
        setFocus(ScanningSerialNo_Txt_SerialNo);
        first_PlayMuiscByName("M114", getValue("hide_MusicList"), true);
        ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_03);
    }
};

function ScanningSerialNo_ClearSerialNoInputText_Private() {
    if (getValue2(ScanningSerialNo_Hide_Type_1) == "1") {
        if (ScanningSerialNo_SN_BCH == "Y") {
            setValue(ScanningSerialNo_Txt_SerialNo_From, "");
            setValue(ScanningSerialNo_Txt_SerialNo_To, "");
        } else {
            setValue(ScanningSerialNo_Txt_SerialNo, "");
        }
    } else {
        if (ScanningSerialNo_SN_BCH == "Y") {
            setValue(ScanningSerialNo_Txt_SubSerialNo_From, "");
            setValue(ScanningSerialNo_Txt_SubSerialNo_To, "");
        } else {
            setValue(ScanningSerialNo_Txt_SubSerialNo, "");
        }
    }
};

function ScanningSerialNo_FocusSerialNoInputText_Private() {
    showViewSingle(ScanningSerialNo_Div_01, inViewsKeys);
    if (getValue2(ScanningSerialNo_Hide_Type_1) == "1") {
        if (ScanningSerialNo_SN_BCH == "Y") {
            setFocus(ScanningSerialNo_Txt_SerialNo_From);
            first_PlayMuiscByName("M110", getValue("hide_MusicList"), true);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_04);
        } else {
            setFocus(ScanningSerialNo_Txt_SerialNo);
            first_PlayMuiscByName("M114", getValue("hide_MusicList"), true);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_03);
        }
    } else {
        if (ScanningSerialNo_SN_BCH == "Y") {
            setFocus(ScanningSerialNo_Txt_SubSerialNo_From);
            first_PlayMuiscByName("M110", getValue("hide_MusicList"), true);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_04);
        } else {
            setFocus(ScanningSerialNo_Txt_SubSerialNo);
            first_PlayMuiscByName("M114", getValue("hide_MusicList"), true);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_03);
        }
    }
};

function ScanningSerialNo_ClearAllSerialNoAndRefresh_Private() {
    ScanningSerialNo_ClearAllSerialNo_Private();
    ScanningSerialNo_RefreshSerialNoTabel_Private(false);
};

function ScanningSerialNo_ClearAllSerialNo_Private() {
    ScanningSerialNo_TableBody = new Array();
    ScanningSerialNo_DeleteSerialNo = new Array();
};

function ScanningSerialNo_ShowButton(buttons) {
    var buttonArrayCode = new Array();
    buttonArrayCode.push("<table width='100%' height='100%' cellpadding='0' cellspacing='0' border='0'><tr>");
    if (buttons == null) {
        buttons = new Array();
    }
    ;
    for (var i = 0; i < buttons.length; i++) {
        if (buttons[i] == "GET") {
            buttonArrayCode.push("<td><input type=\"button\" class=\"input_imgbtn\" style=\"background:url('" + ScanningSerialNo_webRoot + "/img/search.gif');background-repeat:no-repeat;background-position:0 50%;\" id=\"ScanningSerialNo_But_GetSerialNoByTraceID\" value=\"" + ScanningSerialNo_GetSerialNoByTraceID + "\" onkeyup=\"buttonUp(event,ScanningSerialNo_But_GetSerialNoByTraceID_Action)\" onmouseup=\"mouseUp(ScanningSerialNo_But_GetSerialNoByTraceID_Action)\"/></td>");
        } else {
            buttonArrayCode.push("<td><input type=\"button\" class=\"input_imgbtn\" style=\"background:url('" + ScanningSerialNo_webRoot + "/img/Clear.gif');background-repeat:no-repeat;background-position:0 50%;\" id=\"ScanningSerialNo_But_ClearSerialNo\" value=\"" + ScanningSerialNo_ClearSerialNo + "\" onkeyup=\"buttonUp(event,ScanningSerialNo_ClearSerialNo_Action)\" onmouseup=\"mouseUp(ScanningSerialNo_ClearSerialNo_Action)\"/></td>");
        }
    }
    ;buttonArrayCode.push("<td><input type=\"button\" class=\"input_imgbtn\" style=\"background:url('" + ScanningSerialNo_webRoot + "/img/import.gif');background-repeat:no-repeat;background-position:0 50%;\" id=\"ScanningSerialNo_But_LoadSerialNo\" value=\"" + ScanningSerialNo_LoadSerialNo + "\" onkeyup=\"buttonUp(event,ScanningSerialNo_But_LoadSerialNo_Action)\" onmouseup=\"mouseUp(ScanningSerialNo_But_LoadSerialNo_Action)\"/></td>");
    buttonArrayCode.push("<td><input type=\"button\" class=\"input_imgbtn\" style=\"background:url('" + ScanningSerialNo_webRoot + "/img/cancel.gif');background-repeat:no-repeat;background-position:0 50%;\" id=\"ScanningSerialNo_But_Cancel\" value=\"" + ScanningSerialNo_Cancel + "\" onkeyup=\"buttonUp(event,ScanningSerialNo_But_Cancel_Action)\" onmouseup=\"mouseUp(ScanningSerialNo_But_Cancel_Action)\" /></td>");
    buttonArrayCode.push("<td><input type=\"button\" class=\"input_imgbtn\" style=\"background:url('" + ScanningSerialNo_webRoot + "/img/GiveUp.gif');background-repeat:no-repeat;background-position:0 50%;\" id=\"ScanningSerialNo_But_GiveUp\" value=\"" + ScanningSerialNo_GiveUp + "\" onkeyup=\"buttonUp(event,ScanningSerialNo_But_GiveUp_Action)\" onmouseup=\"mouseUp(ScanningSerialNo_But_GiveUp_Action)\" /></td>");
    buttonArrayCode.push("</tr></table>");
    setInnerHTML(ScanningSerialNo_Div_ShowButton, buttonArrayCode.join(""));
};

function ScanningSerialNo_RefreshSerialNoTabel_Private(isAuto) {
    var count = 0;
    for (var i = 0; i < ScanningSerialNo_TableBody.length; i++) {
        if (ScanningSerialNo_TableBody[i][1] == ScanningSerialNo_SCANNED) {
            count++;
        }
    }
    ;
    if (count >= parseInt(ScanningSerialNo_MaxQty) && isAuto && getValue2(ScanningSerialNo_Wxt_OrderQty).indexOf("EA") > 0) {
        ScanningSerialNo_But_LoadSerialNo_Action();
        return;
    }
    ;setInnerHTML(ScanningSerialNo_Div_ShowScannedSerialNoList, ShowTable_GetTableCode(ScanningSerialNo_SerialNoListTableId, ScanningSerialNo_TableTitle, ScanningSerialNo_TableBody, ScanningSerialNo_TableMinLineNumber, ScanningSerialNo_TableMaxLineNumber, true, true, true));
    ScanningSerialNo_ScannedQty = ScanningSerialNo_TableBody.length;
    setValue(ScanningSerialNo_Wxt_ScannedQty, ScanningSerialNo_Message_02.replace("&1", ScanningSerialNo_ScannedQty));
    setValue(ScanningSerialNo_Wxt_ScannedQty_2, ScanningSerialNo_Message_02.replace("&1", ScanningSerialNo_ScannedQty));
    ScanningSerialNo_ClearSerialNoInputText_Private();
    ScanningSerialNo_FocusSerialNoInputText_Private();
};

function ScanningSerialNo_ShowMessage_Private(message) {
    setInnerHTML(ScanningSerialNo_Lbl_Message_1, message);
    setInnerHTML(ScanningSerialNo_Lbl_Message_3, message);
};

function ScanningSerialNo_CheckSerialNo(serialNos) {
    var isOk = 0;
    if (isOk == 0) {
        isOk = ScanningSerialNo_IsSameSerialNo(serialNos);
    }
    ;
    if (isOk == 0) {
        isOk = ScanningSerialNo_CheckSerialNoBufferList(serialNos);
    }
    ;
    if (isOk == 0) {
        isOk = ScanningSerialNo_CheckSerialNoRul_1(serialNos);
    }
    ;
    if (isOk == 0) {
        isOk = ScanningSerialNo_CheckSerialNoIsStock_1(serialNos);
    }
    ;
    if (isOk == 0) {
        isOk = ScanningSerialNo_OtherCheckSerialNo(serialNos);
    }
    ;
    return isOk;
};

function ScanningSerialNo_CheckSerialNoIsStock_1(serialNos) {
    if (ScanningSerialNo_SerialNoIsStockList_1.length == 0) {
        return 0;
    }
    ;
    if (ScanningSerialNo_Module == "OUT") {
        return 0;
    } else if (ScanningSerialNo_Module == "INV") {
        for (var i = 0; i < serialNos.length; i++) {
            var serialNo = serialNos[i];
            if (ScanningSerialNo_SerialNoIsStockList_1.indexOf(";" + serialNo + ";") == (-1)) {
                return 10;
            }
        }
    } else {
        for (var i = 0; i < serialNos.length; i++) {
            var serialNo = serialNos[i];
            if (ScanningSerialNo_SerialNoIsStockList_1.indexOf(";" + serialNo + ";") >= 0) {
                return 9;
            }
        }
    }
    ;
    return 0;
};

function ScanningSerialNo_CheckSerialNoRul_1(serialNos) {
    if (ScanningSerialNo_SerialNoRul_1 == null) {
        return 0;
    }
    ;
    for (var i = 0; i < serialNos.length; i++) {
        var serialNo = serialNos[i];
        var _length = ScanningSerialNo_SerialNoRul_1.LENGTH;
        if (_length != null && _length.length > 0) {
            var length = parseInt(_length);
            if (length > 0 && serialNo.length != length) {
                return 5;
            }
        }
        ;var prefix = ScanningSerialNo_SerialNoRul_1.PREFIX;
        var suffix = ScanningSerialNo_SerialNoRul_1.SUFFIX;
        if (prefix != null && prefix.length > 0) {
            if (serialNo.length <= prefix.length) {
                return 6;
            }
            ;
            if (serialNo.indexOf(prefix) != 0) {
                return 6;
            }
        }
        ;
        if (suffix != null && suffix.length > 0) {
            if (serialNo.length <= suffix.length) {
                return false;
            }
            ;
            if (suffix.length > 0 && (serialNo.substring(0, serialNo.length - suffix.length) + suffix) != serialNo) {
                return 6;
            }
        }
        ;var middleChar = ScanningSerialNo_SerialNoRul_1.MIDDLECHAR;
        var fromPos = ScanningSerialNo_SerialNoRul_1.FROMPOS;
        var toPos = ScanningSerialNo_SerialNoRul_1.TOPOS;
        if (middleChar != null && middleChar.length > 0 && fromPos != null && fromPos.length > 0 && toPos != null && toPos.length > 0) {
            if (middleChar.length > 0 && serialNo.substring(parseInt(fromPos) - 1, parseInt(toPos)) != middleChar) {
                return 7;
            }
        }
        ;var validationScript = ScanningSerialNo_SerialNoRul_1.VALIDATIONSCRIPT;
        if (validationScript != null && validationScript.length > 0) {
            if (validationScript.length > 0 && serialNo.replace(eval("/" + validationScript + "/"), "").length != 0) {
                return 8;
            }
        }
    }
    ;
    return 0;
};

function ScanningSerialNo_CheckSerialNoBufferList(serialNos) {
    if (ScanningSerialNo_SerialNoBufferList_1 == null) {
        return 0;
    }
    ;
    for (var i = 0; i < serialNos.length; i++) {
        var isExist = false;
        for (var j = 0; j < ScanningSerialNo_SerialNoBufferList_1.length; j++) {
            if (serialNos[i] == ScanningSerialNo_SerialNoBufferList_1[j].SERIALNO) {
                isExist = true;
                break;
            }
        }
        ;
        if (!isExist) {
            return 4;
        }
    }
    ;
    return 0;
};

function ScanningSerialNo_CheckSerialNoLength(serialNos) {
    if (ScanningSerialNo_IND_MED != "Y") {
        return 0;
    }
    ;
    for (var i = 0; i < serialNos.length; i++) {
        if (serialNos[i].length != 20 && serialNos[i].length != 16) {
            return 3;
        }
    }
    ;
    return 0;
};

function ScanningSerialNo_IsSameSerialNo(serialNos) {
    for (var i = 0; i < ScanningSerialNo_TableBody.length; i++) {
        for (var j = 0; j < serialNos.length; j++) {
            if (ScanningSerialNo_TableBody[i][0] == serialNos[j]) {
                return 1;
            }
        }
    }
    ;
    return 0;
};

function ScanningSerialNo_CheckOverQty(serialNos) {
    if (!ScanningSerialNo_CanOverQty && serialNos.length + ScanningSerialNo_TableBody.length > ScanningSerialNo_MaxQty) {
        return 2;
    } else {
        return 0;
    }
};

function ScanningSerialNo_CheckSerialNoByDatabaseEnd_Private(isOk, serialNos, errorMessage) {
    if (isOk) {
        for (var i = 0; i < serialNos.length; i++) {
            ScanningSerialNo_AddScanningSerialNo(serialNos[i]);
        }
        ;ScanningSerialNo_RefreshSerialNoTabel_Private(true);
    } else {
        ScanningSerialNo_FocusSerialNoInputText_Private();
        if (errorMessage == null || errorMessage.length == 0) {
            first_PlayMuiscByName("M113", getValue("hide_MusicList"), false);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_06);
        } else {
            ScanningSerialNo_ShowMessage_Private(errorMessage);
        }
    }
};

function ScanningSerialNo_AddScanningSerialNo(serialNo) {
    if (serialNo != null && serialNo.length != 0) {
        ScanningSerialNo_TableBody.push(new Array(serialNo));
    }
};

function ScanningSerialNo_AddScannedSerialNo_Private(serialNo) {
    if (serialNo != null && serialNo.length != 0) {
        ScanningSerialNo_TableBody.push(new Array(serialNo));
    }
};

function ScanningSerialNo_AddZero(number, length) {
    if (number == null) {
        return null;
    } else {
        number += "";
    }
    while (number.length < length) {
        number = "0" + number;
    }
    ;
    return number;
};

function ScanningSerialNo_Txt_SerialNo_From_Action(event) {
    if (event == null || event.keyCode == 13) {
        var idFm = ScanningSerialNo_Txt_SerialNo_From;
        var idTo = ScanningSerialNo_Txt_SerialNo_To;
        if (getValue2(ScanningSerialNo_Hide_Type_1) != "1") {
            idFm = ScanningSerialNo_Txt_SubSerialNo_From;
            idTo = ScanningSerialNo_Txt_SubSerialNo_To;
        }
        ;var serialNoFromValue = getValue2(idFm);
        if (serialNoFromValue.length == 0) {
            setFocus(id);
            first_PlayMuiscByName("M110", getValue("hide_MusicList"), false);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_04);
            return;
        }
        ;setFocus(idTo);
        first_PlayMuiscByName("M110", getValue("hide_MusicList"), true);
        ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_04);
    }
};

function ScanningSerialNo_Txt_SubSerialNo_From_Action(event) {
    ScanningSerialNo_Txt_SerialNo_From_Action(event);
};

function ScanningSerialNo_Txt_SubSerialNo_To_Action(event) {
    ScanningSerialNo_Txt_SerialNo_To_Action(event);
};

function ScanningSerialNo_Txt_SerialNo_To_Action(event) {
    if (event == null || event.keyCode == 13) {
        var idFm = ScanningSerialNo_Txt_SerialNo_From;
        var idTo = ScanningSerialNo_Txt_SerialNo_To;
        if (getValue2(ScanningSerialNo_Hide_Type_1) != "1") {
            idFm = ScanningSerialNo_Txt_SubSerialNo_From;
            idTo = ScanningSerialNo_Txt_SubSerialNo_To;
        }
        ;var serialNoFromValue = getValue2(idFm);
        if (serialNoFromValue.length == 0) {
            setFocus(idFm);
            first_PlayMuiscByName("M110", getValue("hide_MusicList"), false);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_04);
            return;
        }
        ;var serialNoToValue = getValue2(idTo);
        if (serialNoToValue.length == 0) {
            setFocus(idTo);
            first_PlayMuiscByName("M110", getValue("hide_MusicList"), false);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_04);
            return;
        }
        ;var fm_1_Value = serialNoFromValue.substring(0, parseFloat(ScanningSerialNo_firstNumber) - 1);
        var fm_2_Value = serialNoFromValue.substring(parseFloat(ScanningSerialNo_firstNumber) - 1, parseFloat(ScanningSerialNo_lastNumber));
        var fm_3_Value = serialNoFromValue.substring(parseFloat(ScanningSerialNo_lastNumber), serialNoFromValue.length);
        var to_1_Value = serialNoToValue.substring(0, parseFloat(ScanningSerialNo_firstNumber) - 1);
        var to_2_Value = serialNoToValue.substring(parseFloat(ScanningSerialNo_firstNumber) - 1, parseFloat(ScanningSerialNo_lastNumber));
        var to_3_Value = serialNoToValue.substring(parseFloat(ScanningSerialNo_lastNumber), serialNoToValue.length);
        var fmNumber = parseInt(fm_2_Value, 10);
        var toNumber = parseInt(to_2_Value, 10);
        if (fm_1_Value == to_1_Value && fm_3_Value == to_3_Value && first_IsInt(fmNumber) && first_IsInt(toNumber) && fm_2_Value.length == to_2_Value.length && fm_2_Value.length == ScanningSerialNo_NumberLength) {
            ScanningSerialNo_Prefixion = fm_1_Value;
            ScanningSerialNo_Suffixion = fm_3_Value;
            var maxNumber = fmNumber > toNumber ? fmNumber : toNumber;
            var minNumber = fmNumber < toNumber ? fmNumber : toNumber;
            var newSerialNo = new Array();
            for (var i = minNumber; i <= maxNumber; i++) {
                newSerialNo[newSerialNo.length] = ScanningSerialNo_Prefixion + ScanningSerialNo_AddZero(i, ScanningSerialNo_NumberLength) + ScanningSerialNo_Suffixion;
            }
            ;
            switch (ScanningSerialNo_CheckSerialNo(newSerialNo)) {
                case 0:
                    break;
                case 1:
                    first_PlayMuiscByName("M117", getValue("hide_MusicList"), false);
                    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_05);
                    setFocus(idFm);
                    maxNumber = -1;
                    return;
                case 2:
                    first_PlayMuiscByName("M115", getValue("hide_MusicList"), false);
                    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_08);
                    setFocus(idFm);
                    maxNumber = -1;
                    return;
                case 3:
                    first_PlayMuiscByName("M112", getValue("hide_MusicList"), false);
                    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_09);
                    setFocus(idFm);
                    maxNumber = -1;
                    return;
                case 4:
                    first_PlayMuiscByName("M112", getValue("hide_MusicList"), false);
                    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_14);
                    setFocus(idFm);
                    maxNumber = -1;
                    return;
                case 5:
                case 6:
                case 7:
                case 8:
                    first_PlayMuiscByName("M113", getValue("hide_MusicList"), false);
                    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_06);
                    setFocus(idFm);
                    maxNumber = -1;
                    return;
                case 9:
                    first_PlayMuiscByName("", getValue("hide_MusicList"), false);
                    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_15);
                    setFocus(idFm);
                    maxNumber = -1;
                    return;
                case 10:
                    first_PlayMuiscByName("", getValue("hide_MusicList"), false);
                    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_16);
                    setFocus(idFm);
                    maxNumber = -1;
                    return;
                default:
                    return;
            }
            ;
            if (maxNumber >= 0) {
                ScanningSerialNo_CheckSerialNoByDatabase(newSerialNo);
            }
        } else {
            setFocus(idFm);
            first_PlayMuiscByName("M113", getValue("hide_MusicList"), false);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_06);
        }
    }
};

function ScanningSerialNo_Txt_SerialNo_Action(event) {
    if (getValue2(ScanningSerialNo_Hide_Type_1) == "1") {
        ScanningSerialNo_AddSerialNo(event);
    } else if (event == null || event.keyCode == 13) {
        ScanningSerialNo_CheckSerialNoRul(getValue(ScanningSerialNo_Hide_Sku_1), getValue(ScanningSerialNo_Hide_CustomerId_1), "1", ScanningSerialNo_GetSerialRulAction2);
    }
};

function ScanningSerialNo_GetSerialRulAction2(responseText) {
    var replyData = null;
    try {
        replyData = eval('(' + responseText + ')');
    } catch (e) {
        alert(first_ErrorMessage01);
        setInnerHTML("waitingMsg", first_ErrorMessage01 + ":" + e.message);
        return;
    }
    ;var curSEQ = replyData.SEQ;
    if (curSEQ > first_lastSEQUpdate1) {
        first_lastSEQUpdate1 = curSEQ;
        var returnMessage = replyData.mesg;
        if (codeValue_OK == replyData.codeValue) {
            var obj1 = replyData.strData1;
            ScanningSerialNo_SerialNoRul_2 = obj1;
            showViewSingle(_prevView, inViewsKeys);
            if (ScanningSerialNo_CheckSerialNoRule2(getValue2(ScanningSerialNo_Txt_SerialNo))) {
                ScanningSerialNo_FocusSerialNoInputText_Private();
                ScanningSerialNo_ScannedFirstSerialNoList_1.push(getValue2(ScanningSerialNo_Txt_SerialNo));
            } else {
                first_PlayMuiscByName("M113", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_06);
                setFocus(ScanningSerialNo_Txt_SerialNo);
                return;
            }
        } else if (codeValue_NORECORD == replyData.codeValue) {
            showViewSingle(_prevView, inViewsKeys);
        } else {
            showViewSingle(_prevView, inViewsKeys);
            first_EchoMessage(returnMessage, first_Alert, "");
        }
    }
};

function ScanningSerialNo_CheckSerialNoRule2(serialNo) {
    if (ScanningSerialNo_SerialNoRul_2 == null) {
        return true;
    }
    ;var _length = ScanningSerialNo_SerialNoRul_2.LENGTH;
    if (_length != null && _length.length > 0) {
        var length = parseInt(_length);
        if (length > 0 && serialNo.length != length) {
            return false;
        }
    }
    ;var prefix = ScanningSerialNo_SerialNoRul_2.PREFIX;
    var suffix = ScanningSerialNo_SerialNoRul_2.SUFFIX;
    if (prefix != null && prefix.length > 0) {
        if (serialNo.length <= prefix.length) {
            return false;
        }
        ;
        if (serialNo.indexOf(prefix) != 0) {
            return false;
        }
    }
    ;
    if (suffix != null && suffix.length > 0) {
        if (serialNo.length <= suffix.length) {
            return false;
        }
        ;
        if (suffix.length > 0 && (serialNo.substring(0, serialNo.length - suffix.length) + suffix) != serialNo) {
            return false;
        }
    }
    ;var middleChar = ScanningSerialNo_SerialNoRul_2.MIDDLECHAR;
    var fromPos = ScanningSerialNo_SerialNoRul_2.FROMPOS;
    var toPos = ScanningSerialNo_SerialNoRul_2.TOPOS;
    if (middleChar != null && middleChar.length > 0 && fromPos != null && fromPos.length > 0 && toPos != null && toPos.length > 0) {
        if (middleChar.length > 0 && serialNo.substring(parseInt(fromPos) - 1, parseInt(toPos)) != middleChar) {
            return false;
        }
    }
    ;var validationScript = ScanningSerialNo_SerialNoRul_2.VALIDATIONSCRIPT;
    if (validationScript != null && validationScript.length > 0) {
        if (validationScript.length > 0 && serialNo.replace(eval("/" + validationScript + "/"), "").length != 0) {
            return false;
        }
    }
    ;
    return true;
};

function ScanningSerialNo_CheckSerialNoRul(sku, customerId, type, returnFucntion) {
    setValue("ScanningSerialNo_Hide_Sku_2", sku);
    setValue("ScanningSerialNo_Hide_Type_2", type);
    setValue("ScanningSerialNo_Hide_CustomerId_2", customerId);
    _prevView = ScanningSerialNo_Div_01;
    showViewSingle(_div1Waiting, inViewsKeys);
    var thisQkeys = new Array("ScanningSerialNo_Hide_Sku_2", "ScanningSerialNo_Hide_Type_2", "ScanningSerialNo_Hide_CustomerId_2");
    doServerAction(ScanningSerialNo_ClassName, "getSerialRulAction2", thisQkeys, returnFucntion);
};

function ScanningSerialNo_Txt_SubSerialNo_Action(event) {
    ScanningSerialNo_AddSerialNo(event);
};

function ScanningSerialNo_AddSerialNo(event) {
    if (event == null || event.keyCode == 13) {
        var id = ScanningSerialNo_Txt_SerialNo;
        if (getValue2(ScanningSerialNo_Hide_Type_1) != "1") {
            id = ScanningSerialNo_Txt_SubSerialNo;
        }
        ;var serialNoValue = getValue2(id);
        if (serialNoValue.length == 0) {
            setFocus(id);
            first_PlayMuiscByName("M114", getValue("hide_MusicList"), false);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_03);
            return;
        }
        ;
        switch (ScanningSerialNo_CheckSerialNo(new Array(serialNoValue))) {
            case 0:
                break;
            case 1:
                first_PlayMuiscByName("M117", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_05);
                setFocus(id);
                return;
            case 2:
                first_PlayMuiscByName("M115", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_08);
                setFocus(id);
                return;
            case 3:
                first_PlayMuiscByName("M112", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_09);
                setFocus(id);
                return;
            case 4:
                first_PlayMuiscByName("M112", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_14);
                setFocus(id);
                maxNumber = -1;
                return;
            case 5:
            case 6:
            case 7:
            case 8:
                first_PlayMuiscByName("M113", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_06);
                setFocus(id);
                maxNumber = -1;
                return;
            case 9:
                first_PlayMuiscByName("", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_15);
                setFocus(id);
                maxNumber = -1;
                return;
            case 10:
                first_PlayMuiscByName("", getValue("hide_MusicList"), false);
                ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_16);
                setFocus(id);
                maxNumber = -1;
                return;
            default:
                return;
        }
        ;ScanningSerialNo_CheckSerialNoByDatabase(new Array(serialNoValue));
    }
};

function ShowTable_JustForSerialNoDeleteClickAction(tableId, index) {
    if (ScanningSerialNo_SerialNoListTableId == tableId) {
        if (!first_EchoMessage(ScanningSerialNo_Message_13, first_Confirm, "")) {
            return;
        }
        ;ScanningSerialNo_TableBody.splice(index, 1);
        ScanningSerialNo_RefreshSerialNoTabel_Private(false);
    } else if (ScanningSerialNo_AllSerialNoListTableId == tableId) {
        if (!first_EchoMessage(ScanningSerialNo_Message_13, first_Confirm, "")) {
            return;
        }
        ;ScanningSerialNo_TableBody.splice(index, 1);
        ShowTable_JustForSerialNoShowAllInfoAction(ScanningSerialNo_SerialNoListTableId);
    }
};

function ShowTable_JustForSerialNoDoubleClickAction(tableId, index) {
    ShowTable_JustForSerialNoDeleteClickAction(tableId, index);
};

function ShowTable_JustForSerialNoShowAllInfoAction(tableId) {
    if (ScanningSerialNo_SerialNoListTableId == tableId) {
        showViewSingle(ScanningSerialNo_Div_02, inViewsKeys);
        ScanningSerialNo_ScannedQty = ScanningSerialNo_TableBody.length;
        setValue(ScanningSerialNo_Wxt_ScannedQty, ScanningSerialNo_Message_02.replace("&1", ScanningSerialNo_ScannedQty));
        setValue(ScanningSerialNo_Wxt_ScannedQty_2, ScanningSerialNo_Message_02.replace("&1", ScanningSerialNo_ScannedQty));
        setInnerHTML(ScanningSerialNo_Div_ShowAllSerialNoList, ShowTable_GetTableCode(ScanningSerialNo_AllSerialNoListTableId, ScanningSerialNo_TableTitle, ScanningSerialNo_TableBody, ScanningSerialNo_TableMinLineNumber2, ScanningSerialNo_TableMaxLineNumber2, true, true, true));
        setFocus2(ScanningSerialNo_But_Confrim_2);
    }
};

function ScanningSerialNo_But_Confrim_2_Action() {
    showViewSingle(ScanningSerialNo_Div_01, inViewsKeys);
    ScanningSerialNo_RefreshSerialNoTabel_Private(false);
};

function ScanningSerialNoDiv1_quickKey(event) {
    if (event.keyCode == first_keycodeID) {
        ScanningSerialNo_But_Cancel_Action();
    }
};

function ScanningSerialNo_But_GiveUp_Action() {
    ScanningSerialNo_ClearAllSerialNo_Private();
    showViewSingle(ScanningSerialNo_Div_03, inViewsKeys);
    setValue(ScanningSerialNo_Txt_UserId_3, "");
    setValue(ScanningSerialNo_Txt_Password_3, "");
    setFocus(ScanningSerialNo_Txt_UserId_3);
    ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_10);
};

function ScanningSerialNo_Txt_UserId_3_Action(event) {
    if (event == null || event.keyCode == 13) {
        ScanningSerialNo_But_Confirm_3_Action();
    }
};

function ScanningSerialNo_Txt_Password_3_Action(event) {
    if (event == null || event.keyCode == 13) {
        ScanningSerialNo_But_Confirm_3_Action();
    }
};

function ScanningSerialNo_But_Confirm_3_Action() {
    var userIdValue = getValue3(ScanningSerialNo_Txt_UserId_3);
    if (userIdValue.length == 0) {
        setFocus(ScanningSerialNo_Txt_UserId_3);
        ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_10);
        return;
    }
    ;var passwordValue = getValue3(ScanningSerialNo_Txt_Password_3);
    if (passwordValue.length == 0) {
        setFocus(ScanningSerialNo_Txt_Password_3);
        ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_11);
        return;
    }
    ;_prevView = ScanningSerialNo_Div_03;
    showViewSingle(_div1Waiting, inViewsKeys);
    doServerAction(ScanningSerialNo_ClassName, "ScanningSerialNo_CheckUserId", new Array(ScanningSerialNo_Txt_UserId_3, ScanningSerialNo_Txt_Password_3), ScanningSerialNo_CheckUserId, "Y", false);
};

function ScanningSerialNo_CheckUserId(responseText) {
    var replyData = null;
    try {
        replyData = eval('(' + responseText + ')');
    } catch (e) {
        alert(first_ErrorMessage01);
        setInnerHTML("waitingMsg", first_ErrorMessage01 + ":" + e.message);
        return;
    }
    ;var curSEQ = replyData.SEQ;
    if (curSEQ > first_lastSEQUpdate1) {
        first_lastSEQUpdate1 = curSEQ;
        if (codeValue_OK == replyData.codeValue) {
            ScanningSerialNo_GiveUpFlag = true;
            ScanningSerialNo_But_LoadSerialNo_Action();
        } else if (codeValue_NORECORD == replyData.codeValue) {
            showViewSingle(_prevView, inViewsKeys);
        } else {
            showViewSingle(_prevView, inViewsKeys);
            setFocus(ScanningSerialNo_Txt_UserId_3);
            ScanningSerialNo_ShowMessage_Private(ScanningSerialNo_Message_12);
            setValue(ScanningSerialNo_Txt_Password_3, "");
            return;
        }
    }
};

function ScanningSerialNo_But_Cancel_3_Action() {
    setValue(ScanningSerialNo_Txt_UserId_3, "");
    setValue(ScanningSerialNo_Txt_Password_3, "");
    showViewSingle(ScanningSerialNo_Div_01, inViewsKeys);
    ScanningSerialNo_RefreshSerialNoTabel_Private(false);
}

